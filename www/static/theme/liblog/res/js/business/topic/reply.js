var editor=new wangEditor("editor");editor.config.menus=["bold","underline","italic","fontsize","strikethrough","unorderlist","orderlist","img","link","forecolor","bgcolor","location","table","emotion","insertcode","eraser","fullscreen"],editor.config.uploadParams={__CSRF__:G_csrf},editor.config.emotions={"default":{title:"默认",data:"/static/theme/default/res/emotions.data"}},editor.config.uploadImgFileName="img",editor.config.uploadImgUrl="/topic/create/uploadeditor",editor.create(),$("#savetopic").click(function(){var t=editor.$txt.html(),e=editor.$txt.text();if(""===$.trim(e))return $(".reply-error").remove(),$("#savetopic").after('<span class="reply-error">回复内容不能为空！</span>'),!1;$(".reply-error").remove();var r={tid:$("#tid").val(),title:$("#replytitle").val(),comment:e,oldcomment:t,pic:$("#replypic").val(),author:$("#replyauthor").val(),createtime:new Date,__CSRF__:G_csrf};$.ajax({url:"/topic/create/savereply",data:r,type:"POST",success:function(t){0===t.errno?window.location.href="/topic/item/"+$("#tid").val():alert(t.errmsg)}})}),$(".reply_item").delegate(".reply2_btn","click",function(){var t=$(this).attr("rname"),e='<a href="/personal/@'+t+'" target="_blank">@'+t+"</a>";editor.$txt.html(e);var r=$("#createreply").offset().top;$("html,body").animate({scrollTop:r})}),$(".replylist").delegate(".reply_item","mouseover",function(){$(this).find(".fa-thumbs-o-up").removeClass("invisible")}),$(".replylist").delegate(".reply_item","mouseout",function(){$(this).find(".fa-thumbs-o-up").addClass("invisible")}),$(".replylist").delegate(".fa-thumbs-o-up","click",function(){var t=$(this),e={id:$(this).attr("rid"),likers:$(this).attr("login"),__CSRF__:G_csrf};$.ajax({url:"/topic/create/postlike",data:e,type:"POST",success:function(e){if(0===e.errno){var r=t.parent().find(".likeCount");0===e.data.likeCount?(t.removeClass("haslike"),r.html("")):(r.html(e.data.likeCount),t.addClass("haslike"))}else alert(e.errmsg)}})}),$(".replylist").delegate(".fa-trash","click",function(){var t=$(this),e={id:$(this).attr("rid"),tid:$(this).attr("tid"),__CSRF__:G_csrf},r=confirm("确定删除？");r&&$.ajax({url:"/topic/create/removereply",data:e,type:"POST",success:function(e){0===e.errno?t.parents(".reply_item").remove():alert(e.errmsg)}})}),$("#removeItem").on("click",function(){var t=($(this),{id:$(this).attr("rid"),__CSRF__:G_csrf}),e=confirm("确定删除？");e&&$.ajax({url:"/topic/create/removeitem",data:t,type:"POST",success:function(t){0===t.errno?window.location.href="/topic":alert(t.errmsg)}})}),$("#saveedittopic").click(function(){var t=editor.$txt.html(),e=editor.$txt.text(),r=editor.$txt.text(),i={id:$(this).attr("rid"),tid:$("#tid").val(),title:$("#replytitle").val(),comment:r,oldcomment:t,pic:$("#replypic").val(),author:$("#replyauthor").val(),createtime:new Date,__CSRF__:G_csrf};return""===$.trim(e)?($(".reply-error").remove(),$("#saveedittopic").after('<span class="reply-error">回复内容不能为空！</span>'),!1):void $.ajax({url:"/topic/create/savereply",data:i,type:"POST",success:function(t){0===t.errno?window.location.href="/topic/item/"+$("#tid").val():(alert(t.errmsg),window.location.href="/topic")}})});