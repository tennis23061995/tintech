!function(r){r.fn.validate=function(e){function t(){for(var e=r(this).attr("validate").split("|"),t=e.length,i=0;t>i;i++)if(o.hasOwnProperty(e[i])&&0==o[e[i]](r(this)))return!1}function i(){var e=!0;return r(this).find("[validate]").each(function(r,i){return 0==t.call(i)&&(e=!1,a)?!1:void 0}),e&&n.flag&&n.id.val(n.txt),e}var a=e.isone?!0:!1,n={flag:!1,id:r(this).find("input[type='submit']"),txt:"提交中..."},o={required:function(r){return""==r.val()?(_error(r,"required"),!1):void 0},user:function(e){var t;r.ajax({url:"/home/register/isexist",data:{name:e.val(),__CSRF__:r("#csrf").val()},type:"POST",success:function(r){return t=r.status,0===t?(_error(e,"user"),!1):void 0}})},isok:function(r){return/^[a-zA-Z0-9_]+$/.test(r.val())?void 0:(_error(r,"isok"),!1)},password:function(r){return/\s/.test(r.val())?(_error(r,"password"),!1):void 0},minpwd:function(r){return r.val().length<6?(_error(r,"minpwd"),!1):void 0},repassword:function(e){return r("#password").val()!==e.val()?(_error(e,"repassword"),!1):void 0},email:function(r){var e=/^\w+@([0-9a-zA-Z]+[.])+[a-z]{2,4}$/,t=r.val();return t&&!e.test(t)?(_error(r,"email"),!1):void 0},checkemail:function(e){var t;r.ajax({url:"/register/checkemail",data:{email:e.val(),__CSRF__:r("#csrf").val()},type:"POST",success:function(r){return t=r.status,0===t?(_error(e,"checkemail"),!1):void 0}})},phone:function(r){var e=/^1[3|5|8|7]\d{9}$/,t=r.val();return t&&!e.test(t)?(_error(r,"phone"),!1):void 0},code:function(e){var t;return r.ajax({url:"/register/codeisright",data:{code:e.val(),__CSRF__:r("#csrf").val()},type:"POST",success:function(r){t=r.status}}),0===t?(_error(e,"code"),!1):void 0},isqq:function(r){var e=/^\d{5,10}$/,t=r.val();return t&&!e.test(t)?(_error(r,"isqq"),!1):void 0},url:function(r){var e=/^http:\/\/.+\./,t=r.val();return t&&!e.test(t)?(_error(r,"url"),!1):void 0},idcard:function(r){var e=/(^\d{15}$)|(^\d{17}([0-9]|X|x)$)/,t=r.val();return t&&!e.test(t)?(_error(r,"idcard"),!1):void 0}},s={required:"必填项不能为空!",isok:"用户名由数字、字母或下划线组成！",user:"用户已存在！",checkemail:"邮箱已存在！",password:"不能包含空格！",minpwd:"密码长度不能低于6位！",repassword:"两次密码输入不一致！",email:"邮箱格式不正确！",phone:"格式不正确！",url:"格式不正确！",code:"验证码错误，请保持大小写一致！",isqq:"格式不正确！",idcard:"格式不正确！"};return e&&(e.messages&&(s=r.extend(s,e.messages)),e.validate&&(o=r.extend(o,e.validate)),e.submitBtn&&(n=r.extend(n,e.submitBtn))),_error=function(r,t){return e&&e.error?void e.error(r,s[t]):void alert(s[t])},i.call(this)}}(jQuery);