{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\home\\controller\\base.js"
    ],
    "names": [
        "__before",
        "getConfig",
        "_web",
        "assign",
        "session",
        "csrf",
        "uinfo",
        "islogin",
        "think",
        "isEmpty",
        "model",
        "findAll",
        "name",
        "logininfo",
        "appear",
        "tagList",
        "getCache",
        "navList",
        "console",
        "log",
        "parentid",
        "lstparentmenu",
        "menu",
        "i",
        "length",
        "parseInt",
        "id",
        "submenu",
        "submenusid",
        "j",
        "push",
        "parentmenu",
        "JSON",
        "parse",
        "submenus",
        "cache",
        "action",
        "http",
        "THEME_VIEW_PATH",
        "THEME_PATH",
        "sep",
        "theme",
        "Modules_Src",
        "module",
        "findOne",
        "sysdata",
        "displayView",
        "display",
        "controller",
        "base",
        "resolve",
        "reject",
        "then",
        "data"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\home\\controller\\base.js",
    "sourcesContent": [
        "'use strict';\nimport request from \"request\";\n\nexport default class extends think.controller.base {\n    /**\n     * some base method in here\n     */\n    async __before() {\n\n        // assign后台设置\n        let _web = await this.getConfig();\n        this.assign('_web', _web);\n\n        //设置CSRF值\n        let csrf = await this.session(\"__CSRF__\");\n        this.assign(\"csrf\", csrf);\n\n        // 是否登陆\n        let uinfo = await this.session('uInfo');\n        let islogin = (!think.isEmpty(uinfo)) ? 1 : 0;\n        this.assign(\"islogin\", islogin);\n        if (!think.isEmpty(uinfo)) {\n            let logininfo = await this.model(\"home\").findAll('user', { name: uinfo.name });\n            //自己的个人中心基本信息\n            this.assign(\"logininfo\", logininfo[0]);\n        }\n        //是否登陆\n\n        //获取tags\n        let tagList = await this.model(\"home\").findAll('tags', { appear: 1 });\n        this.assign('tagList', tagList);\n\n        //获取导航链接\n        var navList=await getCache('menuList');\n        if(think.isEmpty(navList)){\n          console.log(\"khong cache\");\n          var lstparentmenu=await this.model(\"home\").findAll('item',{parentid:['IN', [0]]});\n          navList={menu:[]};\n          for (var i = 0; i < lstparentmenu.length; i++) {\n            var submenu=await this.model(\"home\").findAll('item',{parentid:['IN', [parseInt(lstparentmenu[i].id)]]});\n            var submenusid=[parseInt(lstparentmenu[i].id)];\n            for (var j = 0; j < submenu.length; j++) {\n              submenusid.push(submenu[j].id);\n            }\n            navList.menu.push({parentmenu:JSON.parse(JSON.stringify(lstparentmenu[i])),submenus:JSON.parse(JSON.stringify(submenu)),submenusid:submenusid});\n          }\n          think.cache('menuList',navList)\n        }\n        else {\n          console.log(\"vao cache\");\n        }\n        //let navList = await this.model(\"home\").findAll('item',{parentid:['IN', [0]]});\n        this.assign(\"navList\", navList);\n\n        //assgin页面action\n        let action = this.http.action;\n        this.assign(\"action\", action);\n\n        // 设置主题地址\n        this.THEME_VIEW_PATH = `${think.THEME_PATH}${think.sep}${_web.theme}${think.sep}${think.Modules_Src}${think.sep}${this.http.module}${think.sep}`;\n        this.assign(\"theme_url\", 'static/theme/' + _web.theme + '/res');\n    }\n    async getConfig() {\n        let sysdata = await this.model(\"home\").findOne('system');\n        this.assign('_web', sysdata);\n        return sysdata;\n    }\n\n    // 渲染主题view层\n    async displayView(name) {\n        return this.display(this.THEME_VIEW_PATH + name + '.html');\n    }\n}\nfunction getCache(name) {\n  return new Promise(function (resolve, reject) {\n    think.cache(name).then(data => {\n    resolve(data);\n    });\n  });\n}\n"
    ]
}