{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\content.js"
    ],
    "names": [
        "indexAction",
        "articlelist",
        "result",
        "list",
        "selval",
        "get",
        "searchtxt",
        "pagenumber",
        "pagesize",
        "map",
        "model",
        "getArticleJoinRecord",
        "getPageCountSelect",
        "assign",
        "title",
        "_logic",
        "Page",
        "think",
        "adapter",
        "page",
        "http",
        "pageData",
        "pagination",
        "config",
        "pageSize",
        "redirect",
        "display",
        "draftlistAction",
        "ispublished",
        "getDraftJoinRecord",
        "tags",
        "on",
        "articleAction",
        "findAll",
        "parentid",
        "lstparentmenu",
        "navList",
        "menu",
        "i",
        "length",
        "parseInt",
        "id",
        "submenu",
        "submenusid",
        "j",
        "push",
        "parentmenu",
        "JSON",
        "parse",
        "submenus",
        "sources",
        "findOne",
        "article",
        "console",
        "log",
        "keywords",
        "substring",
        "split",
        "tagname",
        "item",
        "picurl",
        "tag_selected_id",
        "tag",
        "item_selected_id",
        "addmarkdownAction",
        "tagsList",
        "itemList",
        "gettagsAction",
        "post",
        "term",
        "isEmpty",
        "success",
        "doaddAction",
        "data",
        "titleexist",
        "urlrewrite",
        "itemname",
        "createtime",
        "lastmodified",
        "datetime",
        "Date",
        "cg",
        "updateRecord",
        "citems",
        "where",
        "select",
        "dateC",
        "ct",
        "getFullYear",
        "getMonth",
        "slice",
        "getDate",
        "sm",
        "smap",
        "addRecord",
        "rs",
        "session",
        "uinfo",
        "name",
        "articleinfo",
        "updatestatusAction",
        "pid",
        "status",
        "delsomeAction",
        "arr",
        "deleteRecord",
        "uploadAction",
        "IS_USE_OSS",
        "ALIOSS",
        "service",
        "alioss",
        "file",
        "extend",
        "upload",
        "json",
        "path",
        "filepath",
        "newpath",
        "liFormatDate",
        "toLocaleDateString",
        "uploadPath",
        "UPLOAD_PATH",
        "mkdir",
        "basename",
        "renameSync",
        "uploadeditorAction",
        "uploadfileAction",
        "encodeHTMLContent",
        "str",
        "replace",
        "marked",
        "require",
        "setOptions",
        "renderer",
        "Renderer",
        "gfm",
        "tables",
        "breaks",
        "pedantic",
        "sanitize",
        "smartLists",
        "smartypants",
        "getContent",
        "html",
        "newHtml",
        "ainfo",
        "ainfo_obj",
        "indexOf",
        "end",
        "note",
        "substr",
        "fail",
        "articlehtml"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\controller\\content.js",
    "sourcesContent": [
        "'use strict';\n\nimport fs from \"fs\";\nimport path from \"path\";\nimport Base from './base.js';\n\nexport default class extends Base\n{\n    /**\n     * index action\n     * @return {Promise} []\n     */\n\n    async indexAction()\n    {\n        let articlelist ={},result={},list={};\n        let selval=this.get('type');\n        let searchtxt=this.get('search');\n        let pagenumber=this.get('page')||1;\n        let pagesize=this.get('pagesize')||1;\n        // 设置分页\n        if(selval){\n            //文章筛选\n            let map={};\n            map[this.get('type')]=1;\n            articlelist = await this.model(\"admin\").getArticleJoinRecord(map,pagenumber,pagesize);\n            result = await this.model(\"admin\").getPageCountSelect(map,pagenumber,pagesize);\n            this.assign(\"type\", selval);\n        }else if(searchtxt){\n            //文章搜索\n            let map={title: [\"like\", \"%\"+searchtxt+\"%\"],['li_article.id']:[\"like\", \"%\"+searchtxt*1+\"%\"],_logic: \"OR\"};\n            articlelist = await this.model(\"admin\").getArticleJoinRecord(map,pagenumber,pagesize);\n            result = await this.model(\"admin\").getPageCountSelect(map,pagenumber,pagesize);\n            this.assign(\"type\", '');\n        }else{\n            let map={};\n            articlelist = await this.model(\"admin\").getArticleJoinRecord(map,pagenumber,pagesize);\n            result = await this.model(\"admin\").getPageCountSelect(map,pagenumber,pagesize);\n            this.assign(\"type\", '');\n        }\n        let Page = think.adapter(\"template\", \"page\");\n        let page = new Page(this.http);\n        let pageData = page.pagination(result);\n        this.assign(\"articlelist\", articlelist);\n        this.assign('pageData', pageData);\n\n        // 设置分页\n        let pageSize = await this.config(\"pagesize\");\n        if (!this.get(\"page\")) {\n            return this.redirect(\"/admin/content/index?page=1&pagesize=\" + pageSize);\n        }\n        this.assign(\"title\", \"Danh sách bài viết\");\n        this.assign(\"pagecount\",this.get(\"page\"));\n        this.assign(\"pagesize\",pageSize);\n        this.assign('isdraft', false);\n        return this.display();\n    }\n\n    async draftlistAction(){\n        // 设置分页\n        let map={ispublished:0};\n        let pagenumber=this.get('page')|1;\n        let pagesize=this.get('pagesize')|1;\n        let articlelist = await this.model(\"admin\").getDraftJoinRecord({\n            tags: {on: \"tag, id\"}\n        },map,pagenumber,pagesize);\n        let result = await this.model(\"admin\").getPageCountSelect(map,pagenumber,pagesize);\n        let Page = think.adapter(\"template\", \"page\");\n        let page = new Page(this.http);\n        let pageData = page.pagination(result);\n        this.assign(\"articlelist\", articlelist);\n        this.assign('pageData', pageData);\n        this.assign('isdraft', true);\n\n        // 设置分页\n        let pageSize = await this.config(\"pagesize\");\n        if (!this.get(\"page\")) {\n            return this.redirect(\"/admin/content/draftlist?page=1&pagesize=\" + pageSize);\n        }\n        this.assign(\"title\", \"Bài viết nháp\");\n        this.assign(\"pagecount\",this.get(\"page\"));\n        this.assign(\"pagesize\",pageSize);\n        return this.display('index');\n    }\n    //文章编辑/新增\n    async articleAction()\n    {\n        var lstparentmenu=await this.model(\"admin\").findAll('item',{parentid:['IN', [0]]});\n        var navList={menu:[]};\n        for (var i = 0; i < lstparentmenu.length; i++) {\n          var submenu=await this.model(\"admin\").findAll('item',{parentid:['IN', [parseInt(lstparentmenu[i].id)]]});\n          var submenusid=[];\n          for (var j = 0; j < submenu.length; j++) {\n            submenusid.push(submenu[j].id);\n          }\n          navList.menu.push({parentmenu:JSON.parse(JSON.stringify(lstparentmenu[i])),submenus:JSON.parse(JSON.stringify(submenu)),submenusid:submenusid});\n        }\n        this.assign(\"navList\",navList);\n        var sources=await this.model(\"admin\").findAll('source');\n        this.assign(\"sources\",sources);\n        //编辑或者新增\n        if (this.get('id')) {\n            let article = await this.model('admin').findOne('article',{id:this.get('id')});\n            console.log(article.keywords.substring(1, article.keywords.length - 1));\n            var tags='{\"tags\":[';\n            if(article.keywords)\n            {\n            var keywords=article.keywords.substring(1, article.keywords.length - 1).split(\",\");\n            for (var i = 0; i < keywords.length; i++) {\n              var tagname=((await this.model(\"admin\").findOne(\"tags\",{id: keywords[i]})).tagname);\n              console.log(tagname)\n              if(tagname){\n              var item = \"{\";\n              item+='\"value\":'+keywords[i]+',\"text\":\"'+tagname+'\"';\n              item += \"}\";\n              if(keywords.length==(i+1))tags+=item\n              else tags+=item+\",\"\n              }\n            }\n          }\n            tags+=\"]}\";\n            console.log(tags)\n          //  console.log((await this.model(\"admin\").findOne(\"tags\",{id: 3})).tagname);\n            this.assign(\"tags\",JSON.parse(tags));\n            let picurl=(article.picurl==='')?'/static/common/images/common/default.jpg':article.picurl;\n            let tag_selected_id=article.tag;\n            let item_selected_id=article.item;\n            if(tag_selected_id){\n                this.assign(\"tagselectedId\",tag_selected_id);\n            }else{\n                this.assign(\"tagselectedId\",'');\n            }\n            if(item_selected_id){\n                this.assign(\"itemselectedId\",item_selected_id);\n            }else{\n                this.assign(\"itemselectedId\",'');\n            }\n            this.assign(\"piccss\", 'background-image: url('+picurl+');background-size:82px 82px;');\n            this.assign(\"picurl\", picurl);\n            this.assign('article', article);\n\n            this.assign(\"title\", \"Thêm bài viết\");\n\n        } else {\n            this.assign('article', {});\n            this.assign(\"selectedId\",'');\n            this.assign(\"picurl\", '');\n            this.assign(\"piccss\",'');\n            this.assign(\"tagselectedId\",'');\n            this.assign(\"itemselectedId\",'');\n            this.assign(\"title\", \"Thêm bài viết\");\n        }\n        this.assign('ismarkdown',false);//不显示markdown导入\n        return this.display();\n    }\n\n    //新增markdown文章\n    async addmarkdownAction()\n    {\n        //获取分类\n        let tagsList=await this.model(\"admin\").findAll(\"tags\");\n        this.assign(\"tagsList\",tagsList);\n        //获取类型\n        let itemList=await this.model(\"admin\").findAll(\"item\");\n        this.assign(\"itemList\",itemList);\n        //新增\n        this.assign(\"title\", \"Thêm bài viết markdown\");\n        this.assign('article', {});\n        this.assign(\"selectedId\",'');\n        this.assign(\"picurl\", '');\n        this.assign(\"piccss\",'');\n        this.assign(\"tagselectedId\",'');\n        this.assign(\"itemselectedId\",'');\n        this.assign('ismarkdown',true);\n        return this.display('article');\n\n    }\n    async gettagsAction()\n    {   //编辑或者新增\n        let term=await this.post(\"term\");\n        console.log(\"term\");\n        if(!think.isEmpty(term)){\n             let tagsList=await this.model(\"admin\").findAll(\"tags\",{tagname: ['like', '%'+term+'%']});\n             console.log(JSON.stringify(tagsList))\n             return this.success(JSON.parse(JSON.stringify(tagsList)));\n        }else{\n            return this.success();\n        }\n    }\n    //新增/编辑文章提交接口\n    async doaddAction()\n    {   //编辑或者新增\n      let data=await this.post();\n      var titleexist=false;\n      if(!think.isEmpty(data.id)){\n        var article=await this.model(\"admin\").findOne(\"article\",{title:data.title,id:[\"NOTIN\",data.id]})\n        if(!think.isEmpty(article))titleexist=true;\n      }\n      else {\n        var article=await this.model(\"admin\").findOne(\"article\",{title:data.title})\n        if(!think.isEmpty(article))titleexist=true;\n      }\n        if(titleexist) return this.success({titleexist:titleexist});\n        if(data.item!=0)\n        {\n          var item=await this.model(\"admin\").findOne(\"item\",{id:data.item});\n          data['itemurlrewrite']=item.urlrewrite;\n          data['itemname']=item.itemname;\n        }\n        console.log(data);\n        if(!think.isEmpty(this.post(\"id\"))){\n            let article=await this.model(\"admin\").findOne(\"article\",{id:this.post(\"id\")});\n            data.createtime=article.createtime;\n            data.lastmodified=think.datetime(new Date());\n            let cg=await this.model(\"admin\").findOne(\"item\",{id:article.item});\n            if(!think.isEmpty(cg))\n            {\n              cg.lastmodified=data.lastmodified;\n            await this.model(\"admin\").updateRecord(\"item\",{},cg);\n          }\nif(data.keywords.length>0){\n            var citems=[];\n            for (var item of data.keywords.split(\",\")) {\n              if(!think.isEmpty(item))citems.push(item);\n            }\n            let tagsList = await this.model(\"tags\").where({id: [\"IN\",citems]}).select();\n            for (var item of tagsList) {\n              item.lastmodified=data.lastmodified;\n              await this.model(\"admin\").updateRecord(\"tags\",{},item);\n            }\n          }\n            var dateC=new Date(article.createtime);\n            var ct=dateC.getFullYear() + \"-\" + ('0' + (dateC.getMonth()+1)).slice(-2) + \"-\" + ('0' + dateC.getDate()).slice(-2);\n            var sm=await this.model(\"admin\").findOne(\"sitemap\",{createtime:ct});\n            if(!think.isEmpty(sm))\n            {\n              var smap=JSON.parse(JSON.stringify(sm));\n              smap.lastmodified=data.lastmodified;\n              await this.model(\"admin\").updateRecord(\"sitemap\",{},smap);\n            }\n            else\n            {\n              var smap={createtime:ct,lastmodified:data.lastmodified};\n              await this.model(\"admin\").addRecord(\"sitemap\",smap);\n            }\n\n            let rs=await this.model(\"admin\").updateRecord(\"article\",{},data);\n            if(rs) return this.success();\n        }else{\n            let uinfo = await this.session(\"uInfo\");\n            data.createtime=think.datetime(this.post('createtime'));\n            data.lastmodified=data.createtime;\n            data['author']=uinfo.name;\n            let articleinfo=await this.model(\"admin\").addRecord(\"article\",data);\n            let cg=await this.model(\"admin\").findOne(\"item\",{id:data.item});\n            if(!think.isEmpty(cg)){\n            cg.lastmodified=data.lastmodified;\n            await this.model(\"admin\").updateRecord(\"item\",{},cg);\n          }\nif(data.keywords.length>0){\n            var citems=[];\n            for (var item of data.keywords.split(\",\")) {\n              if(!think.isEmpty(item))citems.push(item);\n            }\n            let tagsList = await this.model(\"tags\").where({id: [\"IN\",citems]}).select();\n            for (var item of tagsList) {\n              item.lastmodified=data.lastmodified;\n              await this.model(\"admin\").updateRecord(\"tags\",{},item);\n            }\n          }\n          var dateC=new Date(data.createtime);\n          console.log(dateC);\n          var ct=dateC.getFullYear() + \"-\" + ('0' + (dateC.getMonth()+1)).slice(-2) + \"-\" + ('0' + dateC.getDate()).slice(-2);\n          var sm=await this.model(\"admin\").findOne(\"sitemap\",{createtime:ct});\n          if(!think.isEmpty(sm))\n          {\n            var smap=JSON.parse(JSON.stringify(sm));\n            smap.lastmodified=data.lastmodified;\n            await this.model(\"admin\").updateRecord(\"sitemap\",{},smap);\n          }\n          else\n          {\n            var smap={createtime:ct,lastmodified:data.lastmodified};\n            await this.model(\"admin\").addRecord(\"sitemap\",smap);\n          }\n            return this.success({id:articleinfo});\n        }\n    }\n\n    async updatestatusAction()\n    {   //草稿箱发布接口\n        let pid=await this.post(\"id\");\n        let status=await this.post(\"ispublished\");\n        if(!think.isEmpty(pid)){\n           let rs=await this.model(\"admin\").updateRecord(\"article\",{id:pid},{ispublished:status});\n            if(rs){\n                return this.success();\n            }\n        }\n    }\n    //删除或批量删除接口\n    async delsomeAction(){\n        let arr=await this.post('delarr[]');\n        let where={id: [\"IN\", arr]};\n        let rs=await this.model(\"admin\").deleteRecord(\"article\",where);\n        if(rs){\n            //操作成功\n            return this.success();\n        }\n    }\n\n    //上传图片接口\n    async uploadAction()\n    {\n\n        let IS_USE_OSS=think.config('OSS.on');\n        if(IS_USE_OSS){\n            //上传OSS图片接口\n            let ALIOSS = think.service(\"alioss\");\n            let alioss = new ALIOSS();\n            let file = think.extend({}, this.file('file'));\n            let rs=await alioss.upload(file);\n            console.log(rs);\n            if(rs){\n                return this.json({path: think.config('OSS.domain')+\"/\"+rs.name});\n            }else{\n                return this.json(\"上传失败！\");\n            }\n        }else{\n            //上传应用服务器图片接口\n            let file = think.extend({}, this.file('file'));\n            let filepath = file.path;\n            let newpath = liFormatDate(new Date().toLocaleDateString());\n            let uploadPath = think.UPLOAD_PATH + '/pics/' + newpath;\n            think.mkdir(uploadPath);\n            let basename = path.basename(filepath);\n            fs.renameSync(filepath, uploadPath + basename);\n            this.json({path: \"static/upload/pics/\" + newpath + basename});\n        }\n    }\n\n    //上传阿里云OSS图片接口\n    async uploadeditorAction()\n    {\n        let IS_USE_OSS=think.config('OSS.on');\n        if(IS_USE_OSS){\n            //上传OSS图片接口\n            let ALIOSS = think.service(\"alioss\");\n            let alioss = new ALIOSS();\n            let file = think.extend({}, this.file('thumb_img'));\n            let rs=await alioss.upload(file);\n            if(rs){\n                return this.json(think.config('OSS.domain')+\"/\"+rs.name);\n            }else{\n                return this.json(\"上传失败！\");\n            }\n        }else{\n            //上传应用服务器图片接口\n            let file = think.extend({}, this.file('thumb_img'));\n            let filepath = file.path;\n            let newpath = liFormatDate(new Date().toLocaleDateString());\n            let uploadPath = think.UPLOAD_PATH + '/pics/' + newpath;\n            think.mkdir(uploadPath);\n            let basename = path.basename(filepath);\n            fs.renameSync(filepath, uploadPath + basename);\n            this.json(\"/static/upload/pics/\" + newpath + basename);\n        }\n    }\n    //上传markdown文件及解析接口、内容分页\n    async uploadfileAction()\n    {\n        let marked = require('marked');\n        marked.setOptions({\n            renderer: new marked.Renderer(),\n            gfm: true,\n            tables: true,\n            breaks: true,\n            pedantic: false,\n            sanitize: true,\n            smartLists: true,\n            smartypants: false\n        });\n\n        let file = think.extend({}, this.file('file'));\n        let data = await getContent(file.path);\n        let html = await marked(data);\n\n        function encodeHTMLContent(str) {\n            return str.replace(/&quot;/g, '\"').replace(/&lt;!--/g,\"<!--\").replace(/--&gt;/g,\"-->\");\n        }\n\n        let newHtml=encodeHTMLContent(html),ainfo={};\n        if(newHtml){\n            let ainfo_obj;\n            if(newHtml.indexOf(\"<!--\")>0 && newHtml.indexOf(\"-->\")>0){\n                //获取注释信息\n                let end=newHtml.indexOf(\"-->\")-1;\n                let note=newHtml.substr(0,newHtml.indexOf(\"-->\")-1)\n                if(note.indexOf(\"{\")>=0 && note.indexOf(\"-\")>0){\n                    ainfo=note.substr(note.indexOf(\"{\"),end);\n                }\n                try{\n                    ainfo_obj = JSON.parse(ainfo);\n                }catch(err){\n                    //通过 err.message 拿到具体的错误信息\n                    return this.fail(1000, '解析错误！请检查文章配置项!');\n                }\n                this.json({articlehtml:newHtml,ainfo:ainfo_obj});\n            }else{\n                this.json({articlehtml:html});\n            }\n        }\n    };\n\n}\r\n"
    ]
}