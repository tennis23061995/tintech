{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\video.js"
    ],
    "names": [
        "indexAction",
        "articlelist",
        "result",
        "list",
        "selval",
        "get",
        "searchtxt",
        "pagenumber",
        "pagesize",
        "map",
        "model",
        "getVideoJoinRecord",
        "getPageVideoCountSelect",
        "assign",
        "title",
        "_logic",
        "Page",
        "think",
        "adapter",
        "page",
        "http",
        "pageData",
        "pagination",
        "config",
        "pageSize",
        "redirect",
        "display",
        "draftlistAction",
        "ispublished",
        "getDraftJoinRecord",
        "tags",
        "on",
        "getPageCountSelect",
        "videoAction",
        "findAll",
        "tagsList",
        "parentid",
        "lstparentmenu",
        "navList",
        "menu",
        "i",
        "length",
        "parseInt",
        "id",
        "submenu",
        "submenusid",
        "j",
        "push",
        "parentmenu",
        "JSON",
        "parse",
        "submenus",
        "findOne",
        "article",
        "keywords",
        "split",
        "tagname",
        "console",
        "log",
        "item",
        "picurl",
        "tag_selected_id",
        "tag",
        "item_selected_id",
        "addmarkdownAction",
        "itemList",
        "gettagsAction",
        "post",
        "term",
        "isEmpty",
        "success",
        "doaddAction",
        "data",
        "urlrewrite",
        "itemname",
        "video",
        "createtime",
        "updateRecord",
        "rs",
        "datetime",
        "addRecord",
        "articleinfo",
        "updatestatusAction",
        "pid",
        "delsomeAction",
        "arr",
        "where",
        "deleteRecord",
        "uploadAction",
        "IS_USE_OSS",
        "ALIOSS",
        "service",
        "alioss",
        "file",
        "extend",
        "upload",
        "json",
        "path",
        "name",
        "filepath",
        "newpath",
        "liFormatDate",
        "Date",
        "toLocaleDateString",
        "uploadPath",
        "UPLOAD_PATH",
        "mkdir",
        "basename",
        "renameSync",
        "uploadeditorAction",
        "uploadfileAction",
        "encodeHTMLContent",
        "str",
        "replace",
        "marked",
        "require",
        "setOptions",
        "renderer",
        "Renderer",
        "gfm",
        "tables",
        "breaks",
        "pedantic",
        "sanitize",
        "smartLists",
        "smartypants",
        "getContent",
        "html",
        "newHtml",
        "ainfo",
        "ainfo_obj",
        "indexOf",
        "end",
        "note",
        "substr",
        "fail",
        "articlehtml"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\controller\\video.js",
    "sourcesContent": [
        "'use strict';\n\nimport fs from \"fs\";\nimport path from \"path\";\nimport Base from './base.js';\n\nexport default class extends Base\n{\n    /**\n     * index action\n     * @return {Promise} []\n     */\n    async indexAction()\n    {\n        let articlelist ={},result={},list={};\n        let selval=this.get('type');\n        let searchtxt=this.get('search');\n        let pagenumber=this.get('page')||1;\n        let pagesize=this.get('pagesize')||1;\n        // 设置分页\n        if(selval){\n            //文章筛选\n            let map={};\n            map[this.get('type')]=1;\n            articlelist = await this.model(\"admin\").getVideoJoinRecord(map,pagenumber,pagesize);\n            result = await this.model(\"admin\").getPageVideoCountSelect(map,pagenumber,pagesize);\n            this.assign(\"type\", selval);\n        }else if(searchtxt){\n            //文章搜索\n            let map={title: [\"like\", \"%\"+searchtxt+\"%\"],['li_video.id']:[\"like\", \"%\"+searchtxt*1+\"%\"],_logic: \"OR\"};\n            articlelist = await this.model(\"admin\").getVideoJoinRecord(map,pagenumber,pagesize);\n            result = await this.model(\"admin\").getPageVideoCountSelect(map,pagenumber,pagesize);\n            this.assign(\"type\", '');\n        }else{\n            let map={};\n            articlelist = await this.model(\"admin\").getVideoJoinRecord(map,pagenumber,pagesize);\n            result = await this.model(\"admin\").getPageVideoCountSelect(map,pagenumber,pagesize);\n            this.assign(\"type\", '');\n        }\n        let Page = think.adapter(\"template\", \"page\");\n        let page = new Page(this.http);\n        let pageData = page.pagination(result);\n        this.assign(\"articlelist\", articlelist);\n        this.assign('pageData', pageData);\n\n        // 设置分页\n        let pageSize = await this.config(\"pagesize\");\n        if (!this.get(\"page\")) {\n            return this.redirect(\"/admin/video/index?page=1&pagesize=\" + pageSize);\n        }\n        this.assign(\"title\", \"Danh sách video\");\n        this.assign(\"pagecount\",this.get(\"page\"));\n        this.assign(\"pagesize\",pageSize);\n        this.assign('isdraft', false);\n        return this.display();\n    }\n\n    async draftlistAction(){\n        // 设置分页\n        let map={ispublished:0};\n        let pagenumber=this.get('page')|1;\n        let pagesize=this.get('pagesize')|1;\n        let articlelist = await this.model(\"admin\").getDraftJoinRecord({\n            tags: {on: \"tag, id\"}\n        },map,pagenumber,pagesize);\n        let result = await this.model(\"admin\").getPageCountSelect(map,pagenumber,pagesize);\n        let Page = think.adapter(\"template\", \"page\");\n        let page = new Page(this.http);\n        let pageData = page.pagination(result);\n        this.assign(\"articlelist\", articlelist);\n        this.assign('pageData', pageData);\n        this.assign('isdraft', true);\n\n        // 设置分页\n        let pageSize = await this.config(\"pagesize\");\n        if (!this.get(\"page\")) {\n            return this.redirect(\"/admin/content/draftlist?page=1&pagesize=\" + pageSize);\n        }\n        this.assign(\"title\", \"Bài viết nháp\");\n        this.assign(\"pagecount\",this.get(\"page\"));\n        this.assign(\"pagesize\",pageSize);\n        return this.display('index');\n    }\n    //文章编辑/新增\n    async videoAction()\n    {\n        //获取分类\n        let tagsList=await this.model(\"admin\").findAll(\"tags\");\n        this.assign(\"tagsList\",tagsList);\n        //获取类型\n        var lstparentmenu=await this.model(\"admin\").findAll('item',{parentid:['IN', [0]]});\n        var navList={menu:[]};\n        for (var i = 0; i < lstparentmenu.length; i++) {\n          var submenu=await this.model(\"admin\").findAll('item',{parentid:['IN', [parseInt(lstparentmenu[i].id)]]});\n          var submenusid=[];\n          for (var j = 0; j < submenu.length; j++) {\n            submenusid.push(submenu[j].id);\n          }\n          navList.menu.push({parentmenu:JSON.parse(JSON.stringify(lstparentmenu[i])),submenus:JSON.parse(JSON.stringify(submenu)),submenusid:submenusid});\n        }\n        this.assign(\"navList\",navList);\n        //编辑或者新增\n        if (this.get('id')) {\n            let article = await this.model('admin').findOne('video',{id:this.get('id')});\n            var tags='{\"tags\":[';\n            if(article.keywords)\n            {\n            var keywords=article.keywords.split(\",\");\n            for (var i = 0; i < keywords.length; i++) {\n              var tagname=((await this.model(\"admin\").findOne(\"tags\",{id: keywords[i]})).tagname);\n              console.log(tagname)\n              if(tagname){\n              var item = \"{\";\n              item+='\"value\":'+keywords[i]+',\"text\":\"'+tagname+'\"';\n              item += \"}\";\n              if(keywords.length==(i+1))tags+=item\n              else tags+=item+\",\"\n              }\n            }\n          }\n            tags+=\"]}\";\n          //  console.log((await this.model(\"admin\").findOne(\"tags\",{id: 3})).tagname);\n            this.assign(\"tags\",JSON.parse(tags));\n            let picurl=(article.picurl==='')?'/static/common/images/common/default.jpg':article.picurl;\n            let tag_selected_id=article.tag;\n            let item_selected_id=article.item;\n            if(tag_selected_id){\n                this.assign(\"tagselectedId\",tag_selected_id);\n            }else{\n                this.assign(\"tagselectedId\",'');\n            }\n            if(item_selected_id){\n                this.assign(\"itemselectedId\",item_selected_id);\n            }else{\n                this.assign(\"itemselectedId\",'');\n            }\n            this.assign(\"piccss\", 'background-image: url('+picurl+');background-size:82px 82px;');\n            this.assign(\"picurl\", picurl);\n            this.assign('article', article);\n\n            this.assign(\"title\", \"Thêm video\");\n\n        } else {\n            this.assign('article', {});\n            this.assign(\"selectedId\",'');\n            this.assign(\"picurl\", '');\n            this.assign(\"piccss\",'');\n            this.assign(\"tagselectedId\",'');\n            this.assign(\"itemselectedId\",'');\n            this.assign(\"title\", \"Thêm video\");\n        }\n        this.assign('ismarkdown',false);//不显示markdown导入\n        return this.display();\n    }\n\n    //新增markdown文章\n    async addmarkdownAction()\n    {\n        //获取分类\n        let tagsList=await this.model(\"admin\").findAll(\"tags\");\n        this.assign(\"tagsList\",tagsList);\n        //获取类型\n        let itemList=await this.model(\"admin\").findAll(\"item\");\n        this.assign(\"itemList\",itemList);\n        //新增\n        this.assign(\"title\", \"Thêm bài viết markdown\");\n        this.assign('article', {});\n        this.assign(\"selectedId\",'');\n        this.assign(\"picurl\", '');\n        this.assign(\"piccss\",'');\n        this.assign(\"tagselectedId\",'');\n        this.assign(\"itemselectedId\",'');\n        this.assign('ismarkdown',true);\n        return this.display('article');\n\n    }\n    async gettagsAction()\n    {   //编辑或者新增\n        let term=await this.post(\"term\");\n        console.log(\"term\");\n        if(!think.isEmpty(term)){\n             let tagsList=await this.model(\"admin\").findAll(\"tags\",{tagname: ['like', '%'+term+'%']});\n             console.log(JSON.stringify(tagsList))\n             return this.success(JSON.parse(JSON.stringify(tagsList)));\n        }else{\n            return this.success();\n        }\n    }\n    //新增/编辑文章提交接口\n    async doaddAction()\n    {   //编辑或者新增\n        console.log(\"term\");\n        let data=await this.post();\n        if(data.item!=0)\n        {\n          var item=await this.model(\"admin\").findOne(\"item\",{id:data.item});\n          data['itemurlrewrite']=item.urlrewrite;\n          data['itemname']=item.itemname;\n        }\n        console.log(data);\n\n        if(!think.isEmpty(this.post(\"id\"))){\n            var video=await this.model(\"admin\").findOne(\"video\",{id:this.post(\"id\")});\n            data.createtime=video.createtime;\n            let rs=await this.model(\"admin\").updateRecord(\"video\",{},data);\n            if(rs) return this.success();\n        }else{\n            data.createtime=think.datetime(this.post('createtime'));\n            let articleinfo=await this.model(\"admin\").addRecord(\"video\",data);\n            return this.success({id:articleinfo});\n        }\n    }\n\n    async updatestatusAction()\n    {   //草稿箱发布接口\n        let pid=await this.post(\"id\");\n        if(!think.isEmpty(pid)){\n           let rs=await this.model(\"admin\").updateRecord(\"video\",{id:pid},{ispublished:1});\n            if(rs){\n                return this.success();\n            }\n        }\n    }\n    //删除或批量删除接口\n    async delsomeAction(){\n        let arr=await this.post('delarr[]');\n        let where={id: [\"IN\", arr]};\n        let rs=await this.model(\"admin\").deleteRecord(\"video\",where);\n        if(rs){\n            //操作成功\n            return this.success();\n        }\n    }\n\n    //上传图片接口\n    async uploadAction()\n    {\n\n        let IS_USE_OSS=think.config('OSS.on');\n        if(IS_USE_OSS){\n            //上传OSS图片接口\n            let ALIOSS = think.service(\"alioss\");\n            let alioss = new ALIOSS();\n            let file = think.extend({}, this.file('file'));\n            let rs=await alioss.upload(file);\n            console.log(rs);\n            if(rs){\n                return this.json({path: think.config('OSS.domain')+\"/\"+rs.name});\n            }else{\n                return this.json(\"上传失败！\");\n            }\n        }else{\n            //上传应用服务器图片接口\n            let file = think.extend({}, this.file('file'));\n            let filepath = file.path;\n            let newpath = liFormatDate(new Date().toLocaleDateString());\n            let uploadPath = think.UPLOAD_PATH + '/pics/' + newpath;\n            think.mkdir(uploadPath);\n            let basename = path.basename(filepath);\n            fs.renameSync(filepath, uploadPath + basename);\n            this.json({path: \"static/upload/pics/\" + newpath + basename});\n        }\n    }\n\n    //上传阿里云OSS图片接口\n    async uploadeditorAction()\n    {\n        let IS_USE_OSS=think.config('OSS.on');\n        if(IS_USE_OSS){\n            //上传OSS图片接口\n            let ALIOSS = think.service(\"alioss\");\n            let alioss = new ALIOSS();\n            let file = think.extend({}, this.file('thumb_img'));\n            let rs=await alioss.upload(file);\n            if(rs){\n                return this.json(think.config('OSS.domain')+\"/\"+rs.name);\n            }else{\n                return this.json(\"上传失败！\");\n            }\n        }else{\n            //上传应用服务器图片接口\n            let file = think.extend({}, this.file('thumb_img'));\n            let filepath = file.path;\n            let newpath = liFormatDate(new Date().toLocaleDateString());\n            let uploadPath = think.UPLOAD_PATH + '/pics/' + newpath;\n            think.mkdir(uploadPath);\n            let basename = path.basename(filepath);\n            fs.renameSync(filepath, uploadPath + basename);\n            this.json(\"/static/upload/pics/\" + newpath + basename);\n        }\n    }\n    //上传markdown文件及解析接口、内容分页\n    async uploadfileAction()\n    {\n        let marked = require('marked');\n        marked.setOptions({\n            renderer: new marked.Renderer(),\n            gfm: true,\n            tables: true,\n            breaks: true,\n            pedantic: false,\n            sanitize: true,\n            smartLists: true,\n            smartypants: false\n        });\n\n        let file = think.extend({}, this.file('file'));\n        let data = await getContent(file.path);\n        let html = await marked(data);\n\n        function encodeHTMLContent(str) {\n            return str.replace(/&quot;/g, '\"').replace(/&lt;!--/g,\"<!--\").replace(/--&gt;/g,\"-->\");\n        }\n\n        let newHtml=encodeHTMLContent(html),ainfo={};\n        if(newHtml){\n            let ainfo_obj;\n            if(newHtml.indexOf(\"<!--\")>0 && newHtml.indexOf(\"-->\")>0){\n                //获取注释信息\n                let end=newHtml.indexOf(\"-->\")-1;\n                let note=newHtml.substr(0,newHtml.indexOf(\"-->\")-1)\n                if(note.indexOf(\"{\")>=0 && note.indexOf(\"-\")>0){\n                    ainfo=note.substr(note.indexOf(\"{\"),end);\n                }\n                try{\n                    ainfo_obj = JSON.parse(ainfo);\n                }catch(err){\n                    //通过 err.message 拿到具体的错误信息\n                    return this.fail(1000, '解析错误！请检查文章配置项!');\n                }\n                this.json({articlehtml:newHtml,ainfo:ainfo_obj});\n            }else{\n                this.json({articlehtml:html});\n            }\n        }\n    };\n\n}\r\n"
    ]
}