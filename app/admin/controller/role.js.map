{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\role.js"
    ],
    "names": [
        "init",
        "mydb",
        "title",
        "edit",
        "add",
        "action",
        "indexAction",
        "info",
        "db",
        "page",
        "get",
        "pagesize",
        "model",
        "getIndex",
        "mydata",
        "assign",
        "itemList",
        "pageData",
        "display",
        "itemAction",
        "id",
        "getItem",
        "item",
        "saveAction",
        "data",
        "post",
        "doSave",
        "status",
        "success",
        "delsomeAction",
        "arr",
        "where",
        "deleteRecord",
        "rs",
        "perlistAction",
        "findAll",
        "tagList",
        "findOne",
        "rolePermissions",
        "i",
        "ilist",
        "obj",
        "tag",
        "prr",
        "pbj",
        "j",
        "pername",
        "permission",
        "push",
        "name",
        "newArr",
        "think",
        "isEmpty",
        "pid",
        "roleArr",
        "split",
        "k",
        "rolesaveAction",
        "newdata",
        "console",
        "log",
        "updateRecord"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\controller\\role.js",
    "sourcesContent": [
        "'use strict';\nlet init={\n    mydb:\"manage_role\",\n    title:\"Danh sách quyền\",\n    edit:\"Cập nhật quyền\",\n    add:\"Thêm quyền\",\n    action:\"role\"\n}\nimport Base from './base.js';\nexport default class extends Base {\n  /**\n   * index action\n   * @return {Promise} []\n   */\n      async indexAction(){\n          let info={\n            db:init.mydb,\n            page:this.get(\"page\")||1,\n            pagesize:this.get(\"pagesize\")||10\n          }\n          let mydata=await this.model('util').getIndex(info);\n          this.assign(\"itemList\",mydata.itemList);\n          this.assign('pageData',mydata.pageData);\n          this.assign(\"title\",init.title);\n          this.assign(\"action\",init.action);\n          return this.display();\n      }\n\n     async itemAction(){\n\n           let info={\n             db:init.mydb,\n             edit:init.edit,\n             add:init.add,\n             id:this.get('id')\n           }\n           let mydata=await this.model('util').getItem(info);\n           this.assign(\"title\",mydata.title);\n           this.assign('item',mydata.item);\n           this.assign(\"action\",init.action);\n           return this.display();\n     }\n\n     //编辑或者新增接口\n     async saveAction() {\n          let info={\n            db:init.mydb,\n            data:this.post(),\n            id:this.post('id')\n          }\n          let mydata=await this.model('util').doSave(info);\n          if(mydata.status===1) return this.success();\n    }\n\n    //删除或批量删除接口\n    async delsomeAction(){\n          let info={\n            db:init.mydb,\n            arr:this.post('delarr[]')\n          }\n          let where={id: [\"IN\", info.arr]};\n          let rs=await this.model(\"admin\").deleteRecord(info.db,where);\n          if(rs) return this.success();\n    }\n    //权限\b\b\b列表\n    async perlistAction(){\n\n      let tagList=await this.model('admin').findAll('manage_tag');\n      let rolePermissions=await this.model('admin').findOne('manage_role',{id:this.get('id')});\n      let arr=[];\n      for(var i in tagList){\n        let ilist={},obj={};\n        ilist=await this.model('admin').findAll('manage_permission',{tag:tagList[i].id});\n        let prr=[],pbj={};\n        //循环权限\n        for(var j in ilist){\n          pbj={\n             'id':ilist[j].id,\n             'pername':ilist[j].pername,\n             'permission':ilist[j].permission\n          }\n          prr.push(pbj);\n        }\n        //拼组数据\n        obj={\n          'name':tagList[i].name,\n          'perlist':prr\n        }\n        arr.push(obj);\n      }\n\n      //转换成数字数组\n      let newArr=[]\n      if(!think.isEmpty(rolePermissions.pid)){\n        let roleArr=(rolePermissions.pid).split(\",\");\n        let item;\n        for(var k in roleArr){\n          item=roleArr[k]*1\n          newArr.push(item);\n        }\n      }\n\n      this.assign('itemList',arr);\n      this.assign('rid',this.get('id'));\n      this.assign('title','Cấp vai trò');\n      this.assign('newArr',newArr);\n      return this.display();\n    }\n    async rolesaveAction(){\n           let newdata=await this.post();\n           console.log(newdata);\n           if(!think.isEmpty(this.post('id'))){\n               let rs=await this.model('admin').updateRecord('manage_role',{id:this.post('id')},newdata);\n               if(rs) return this.success();\n           }\n    }\n\n}\n"
    ]
}