{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\item.js"
    ],
    "names": [
        "init",
        "mydb",
        "title",
        "edit",
        "add",
        "action",
        "indexAction",
        "parentid",
        "get",
        "model",
        "findOne",
        "id",
        "parentmenu",
        "info",
        "where",
        "db",
        "page",
        "pagesize",
        "getIndex",
        "mydata",
        "assign",
        "itemList",
        "pageData",
        "display",
        "itemAction",
        "getItem",
        "item",
        "saveAction",
        "data",
        "post",
        "lastmodified",
        "think",
        "datetime",
        "Date",
        "isEmpty",
        "menu",
        "itemname",
        "findAll",
        "items",
        "i",
        "length",
        "itemurlrewrite",
        "urlrewrite",
        "updateRecord",
        "videos",
        "topics",
        "cache",
        "doSave",
        "status",
        "success",
        "delsomeAction",
        "arr",
        "deleteRecord",
        "rs"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\controller\\item.js",
    "sourcesContent": [
        "'use strict';\nlet init={\n    mydb:\"item\",\n    title:\"Danh sách danh mục\",\n    edit:\"Cập nhật danh mục\",\n    add:\"Thêm danh mục\",\n    action:\"item\"\n}\nimport Base from './base.js';\nexport default class extends Base {\n  /**\n   * index action\n   * @return {Promise} []\n   */\n      async indexAction(){\n        let parentid=this.get('id')||0;\n        let parentmenu=await this.model('admin').findOne('item',{id:parentid});\n          let info={\n            where:{parentid:parentid},\n            db:init.mydb,\n            page:this.get(\"page\")||1,\n            pagesize:this.get(\"pagesize\")||10\n          }\n          //console.log(parentid);\n          let mydata=await this.model('util').getIndex(info);\n          this.assign(\"itemList\",mydata.itemList);\n          this.assign(\"parentmenu\",parentmenu);\n          this.assign('pageData',mydata.pageData);\n          this.assign(\"title\",init.title);\n          this.assign(\"action\",init.action);\n          return this.display();\n      }\n\n     async itemAction(){\n\n           let info={\n             db:init.mydb,\n             edit:init.edit,\n             add:init.add,\n             id:this.get('id')\n           }\n           var parentid= await this.get('pid');\n           let mydata=await this.model('util').getItem(info);\n           this.assign(\"parentid\",parentid);\n           this.assign(\"title\",mydata.title);\n           this.assign('item',mydata.item);\n           this.assign(\"action\",init.action);\n           return this.display();\n     }\n\n     //编辑或者新增接口\n     async saveAction() {\n          let info={\n            db:init.mydb,\n            data:this.post(),\n            id:this.post('id')\n          }\n          info.data.lastmodified=think.datetime(new Date());\n          if(!think.isEmpty(info.id) || info.id!=0)\n          {\n            var menu=await this.model(\"admin\").findOne(\"item\",{id:info.id});\n            if(menu.itemname!=info.data.itemname)\n            {\n                var items=await this.model(\"admin\").findAll(\"article\",{item:info.id});\n                for (var i = 0; i < items.length; i++) {\n                  var item=items[i];\n                  item.itemurlrewrite=info.data.urlrewrite;\n                  item.itemname=info.data.itemname;\n                  await this.model(\"admin\").updateRecord(\"article\",{},item);\n                }\n                var videos=await this.model(\"admin\").findAll(\"video\",{item:info.id});\n                for (var i = 0; i < videos.length; i++) {\n                  var item=videos[i];\n                  item.itemurlrewrite=info.data.urlrewrite;\n                  item.itemname=info.data.itemname;\n                  await this.model(\"admin\").updateRecord(\"video\",{},item);\n                }\n                var topics=await this.model(\"admin\").findAll(\"topic\",{item:info.id});\n                for (var i = 0; i < topics.length; i++) {\n                  var item=topics[i];\n                  item.itemurlrewrite=info.data.urlrewrite;\n                  item.itemname=info.data.itemname;\n                  await this.model(\"admin\").updateRecord(\"topic\",{},item);\n                }\n            }\n          }\n          think.cache('menuList',null);\n          let mydata=await this.model('util').doSave(info);\n          if(mydata.status===1) return this.success({parentid:info.data.parentid});\n    }\n\n    //删除或批量删除接口\n    async delsomeAction(){\n          let info={\n            db:init.mydb,\n            arr:this.post('delarr[]')\n          }\n          let where={id: [\"IN\", info.arr]};\n          think.cache('menuList',null);\n          let rs=await this.model(\"admin\").deleteRecord(info.db,where);\n          if(rs) return this.success();\n    }\n\n}\n"
    ]
}